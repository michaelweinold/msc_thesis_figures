\documentclass[crop]{standalone}

\usepackage{../../../supplementary/header/header_pgfplot_standalone}

\pgfplotsset{compat=newest,
			xtick pos=left,
			ytick pos=left
			}
			

\begin{document}
\begin{tikzpicture}

\begin{axis}[
%Grouping
	name=top,
	at={(0,0)},
	height=130pt,
	width=418pt,
%Type
    enlarge x limits=0.05,
	ybar stacked,
	bar width=15pt,
	nodes near coords,
	axis on top,
%Domain
	ymin=0,ymax=100,
	xmin=2003,xmax=2020,
%Axis Labels
    ylabel style={align=center},
    ylabel = {  \\ Cost Model},
	xticklabels={,,},
	yticklabels={,,20,40,60,80,100},
	/pgf/number format/1000 sep={},
]
\addplot [ybar,fill=green!20,draw=black!70]
	table [col sep=comma, x=year, y=wafer]
	{../data/costmodel_data.csv};
\addplot [ybar,fill=red!20,draw=black!70]
	table [col sep=comma, x=year, y=epi]
	{../data/costmodel_data.csv};
\addplot [ybar,fill=blue!20,draw=black!70]
	table [col sep=comma, x=year, y=subst]
	{../data/costmodel_data.csv};
\addplot [ybar,fill=violet!20,draw=black!70]
	table [col sep=comma, x=year, y=phos]
	{../data/costmodel_data.csv};
\addplot [ybar,fill=cyan!20,draw=black!70]
	table [col sep=comma, x=year, y=pack]
	{../data/costmodel_data.csv};
\end{axis}

\begin{axis}[
%Grouping
	name=bottom,
	at={(top.west)},
	yshift=-90pt,
	anchor=west,
	height=130pt,
	width=418pt,
%Type
    enlarge x limits=0.05,
	ybar stacked,
	bar width=15pt,
	nodes near coords,
	axis on top,
%Domain
	ymin=0,ymax=100,
	xmin=2003,xmax=2020,
%Axis Labels
    ylabel style={align=center},
    ylabel = {Manuf. Cost [\$(2020)] \\ U.S. DoE SSL Rep.},
	%xticklabels={,,},
	/pgf/number format/1000 sep={},
%Legend
	legend entries={Wafer Processing,Epitaxy,Substrate,Phosphor,Packaging},
	legend pos=north west,
	legend cell align={left},
	legend style={draw=none},
]
%Projections
\addplot [ybar,fill=green!10,draw=green!70]
	table [col sep=comma, x=year, y=wafer]
	{../data/cost_high_relative_projection.csv};
\addplot [ybar,fill=red!10,draw=red!70]
	table [col sep=comma, x=year, y=epi]
	{../data/cost_high_relative_projection.csv};
\addplot [ybar,fill=blue!10,draw=blue!70]
	table [col sep=comma, x=year, y=subst]
	{../data/cost_high_relative_projection.csv};
\addplot [ybar,fill=violet!10,draw=violet!70]
	table [col sep=comma, x=year, y=phos]
	{../data/cost_high_relative_projection.csv};
\addplot [ybar,fill=cyan!10,draw=cyan!70]
	table [col sep=comma, x=year, y=pack]
	{../data/cost_high_relative_projection.csv};
%Reports
\addplot [ybar,fill=green!20,draw=black!70]
	table [col sep=comma, x=year, y=wafer]
	{../data/cost_high_relative.csv};
\addplot [ybar,fill=red!20,draw=black!70]
	table [col sep=comma, x=year, y=epi]
	{../data/cost_high_relative.csv};
\addplot [ybar,fill=blue!20,draw=black!70]
	table [col sep=comma, x=year, y=subst]
	{../data/cost_high_relative.csv};
\addplot [ybar,fill=violet!20,draw=black!70]
	table [col sep=comma, x=year, y=phos]
	{../data/cost_high_relative.csv};
\addplot [ybar,fill=cyan!20,draw=black!70]
	table [col sep=comma, x=year, y=pack]
	{../data/cost_high_relative.csv};
\end{axis}

\end{tikzpicture}
\end{document}
